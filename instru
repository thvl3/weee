# Inject: Discord Webhook Investigation - Phase 2 (Focus on lwp-request and broader search)

## 1. Examine the suspicious /usr/bin/lwp-request script (flagged by rkhunter)
echo "### Contents of /usr/bin/lwp-request (this was flagged by rkhunter as a script) ###"
sudo cat /usr/bin/lwp-request
echo "### >> CAREFULLY EXAMINE THE OUTPUT ABOVE FOR ANY URLS (especially discord.com) OR OBFUSCATED CODE << ###"

## 2. Broader search for the full webhook string in more system directories
echo "### Searching for 'discord.com/api/webhooks' string in common system binary/library paths ###"
sudo grep -rli "discord.com/api/webhooks" /usr/bin /usr/sbin /bin /sbin /lib /usr/lib /var/www /srv 2>/dev/null || echo "No direct hits for full webhook URL in these system paths."

## 3. Broader search for 'discord.com/api' (partial string)
echo "### Searching for 'discord.com/api' string in common system binary/library paths ###"
sudo grep -rli "discord.com/api" /usr/bin /usr/sbin /bin /sbin /lib /usr/lib /var/www /srv 2>/dev/null || echo "No direct hits for partial webhook URL in these system paths."

## 4. Reminder on identifying the Webhook ID
echo "### If a Discord webhook URL is found (e.g., https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN), the Webhook ID is the numerical part. ###"
echo "### The script itself making the call (like /usr/bin/lwp-request if it's the culprit) is the evidence of the outbound connection. ###"
